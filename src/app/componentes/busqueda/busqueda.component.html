<!-- Paso 4.1 hacemos el template basico de busqueda -->
<div class="max-w-3xl mx-auto p-4 sm:p-6">
    <div class="text-center mb-10">
        <h1
            class="text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600 mb-2">
            El Tiempo en tu Ciudad
        </h1>
        <p class="text-slate-500 text-lg">Consulta el clima actual y la previsión para los próximos días</p>
    </div>

    <!-- FORMULARIO DE BÚSQUEDA -->
    <div class="relative mb-10 group">
        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
            <svg xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6 text-slate-400 group-focus-within:text-blue-500 transition-colors" fill="none"
                viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
        </div>
        <input type="text" [(ngModel)]="ciudadBuscada" (keyup.enter)="buscar()"
            placeholder="Escribe el nombre de la ciudad (ej. Madrid, Londres)..."
            class="w-full pl-12 pr-32 py-4 bg-white border border-slate-200 rounded-2xl shadow-sm text-lg placeholder-slate-400 focus:outline-none focus:ring-4 focus:ring-blue-100 focus:border-blue-500 transition-all duration-300" />
        <button (click)="buscar()" [disabled]="cargando"
            class="absolute right-2 top-2 bottom-2 px-6 bg-blue-600 text-white font-semibold rounded-xl hover:bg-blue-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-all duration-200 shadow-md hover:shadow-lg active:scale-95">
            @if (cargando) {
            <div class="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
            } @else {
            Buscar
            }
        </button>
    </div>

    <!-- MENSAJE DE ERROR -->
    @if (error) {
    <div class="bg-red-50 border-l-4 border-red-500 text-red-700 p-4 rounded-r-lg mb-8 shadow-sm animate-fade-in">
        <div class="flex items-center">
            <svg class="h-6 w-6 text-red-500 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <p><strong>Error:</strong> {{ error }}</p>
        </div>
    </div>
    }

    <!-- INDICADOR DE CARGA -->
    @if (cargando) {
    <div class="text-center py-12">
        <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-blue-100 border-t-blue-600">
        </div>
        <p class="mt-4 text-slate-500 font-medium">Buscando información meteorológica...</p>
    </div>
    }

    <!-- RESULTADOS -->
    @if (resultados && !cargando) {
    <div class="bg-white rounded-2xl shadow-xl shadow-blue-900/5 overflow-hidden border border-slate-100 cursor-pointer hover:shadow-2xl hover:shadow-blue-900/10 hover:-translate-y-1 transition-all duration-300 group"
        [routerLink]="['/detalles', resultados.name]">
        <div class="p-6 sm:p-8">
            <div class="flex justify-between items-start mb-6">
                <div>
                    <h2 class="text-3xl font-bold text-slate-800 mb-1 group-hover:text-blue-600 transition-colors">
                        {{ resultados.name }}
                    </h2>
                    <p class="text-slate-500 font-medium">Resultado de la búsqueda</p>
                </div>
                <button (click)="$event.stopPropagation(); toggleFavorito(resultados.name)"
                    class="group p-2 rounded-full hover:bg-slate-50 transition-colors focus:outline-none"
                    [title]="esFavorito(resultados.name) ? 'Quitar de favoritos' : 'Añadir a favoritos'">
                    <!-- Corazón Lleno (Favorito) -->
                    <svg *ngIf="esFavorito(resultados.name)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                        fill="currentColor" class="w-8 h-8 text-red-500 animate-heart-beat drop-shadow-sm">
                        <path
                            d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z" />
                    </svg>

                    <!-- Corazón Contorno (No Favorito) -->
                    <svg *ngIf="!esFavorito(resultados.name)" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                        class="w-8 h-8 text-slate-400 group-hover:text-red-500 transition-colors duration-300">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" />
                    </svg>
                </button>
            </div>

            <!-- REUTILIZAMOS EL COMPONENTE DE TIEMPO ACTUAL -->
            <app-tiempo-actual-item [tiempoInfo]="{
            ciudad: resultados.name,
            temperatura: resultados.main.temp,
            descripcion: resultados.weather[0].description,
            icono: resultados.weather[0].icon,
            viento: resultados.wind.speed
        }"></app-tiempo-actual-item>

            <div
                class="mt-6 pt-6 border-t border-slate-100 flex justify-end items-center text-blue-600 font-medium group-hover:translate-x-1 transition-transform">
                Ver detalles completos
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd"
                        d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                        clip-rule="evenodd" />
                </svg>
            </div>
        </div>
    </div>
    }
</div>